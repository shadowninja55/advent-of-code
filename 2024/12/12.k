g:0:"i.txt"
S:,/(s';s:{y@x+!#y})@\:/:-1 1
i:{x|/(S@\:x)*g=/:S@\:g}/(2##g)#!#,/g
R:{x@n!-1+!n:#x}
P:{+/(#'.g)*+/'(,/+/x)@.g:=,/i}
P e:~i=/:S@\:i
P e&R[e]|i=/:R[S]@'S@\:i
